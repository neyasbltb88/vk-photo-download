{"version":3,"sources":["node_modules/browser-pack/_prelude.js","app/scripts/modules/handlers.js","app/scripts/modules/photo-download.js","app/scripts/modules/templates.js","app/scripts/vk-photo-download.js","node_modules/downloadjs/download.js"],"names":[],"mappings":"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,KAfvF,yHAmBD,KAAK,SAAL,CAAe,iBAnBd,+HAwBD,KAAK,SAAL,CAAe,iBAxBd,+EA2BD,KAAK,SAAL,CAAe,kBA3Bd,oDA4ByB,KAAK,KAAL,CAAW,GAAX,CAAe,OAAf,CA5BzB,6KAkCD,KAAK,SAAL,CAAe,iBAlCd,qBAkC0C,KAAK,SAAL,CAAe,kBAlCzD,oDAmCyB,KAAK,KAAL,CAAW,GAAX,CAAe,OAAf,CAnCzB,sCAqCD,KAAK,SAAL,CAAe,gBArCd,eAqCmC,KAAK,SAAL,CAAe,kBArClD,mBAqC6E,KAAK,SAAL,CAAe,QArC5F;AAAA;AA0CH,K,CAAC;;;;;;;;;;;;AChHV;;;;AAGA,MAAM,CAAC,aAAP,GAAuB,IAAI,sBAAJ,CAAkB;AACrC,EAAA,QAAQ,EAAE;AAD2B,CAAlB,CAAvB;;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"../vk-photo-download.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import Download from 'downloadjs';\r\n\r\n// Класс для управления обработчиками внутри кнопки\r\nexport default class HandlersManager {\r\n    constructor(params = {}) {\r\n            // Переданный инстанс главного класса\r\n            this.PhotoDownload = params.PhotoDownload;\r\n\r\n            // Тип события по умолчанию для обработчиков\r\n            this.default_event_name = 'click';\r\n\r\n            // Объект с перечислением всех возможных обработчиков\r\n            this.handlers = {\r\n                testHandler: this._testHandler,\r\n                preventHandler: this._preventHandler,\r\n                preventStopHandler: this._preventStopHandler,\r\n                newTabHandler: this._newTabHandler,\r\n                downloadHandler: this._downloadHandler,\r\n            }\r\n        } // constructor\r\n\r\n    // Установить один или несколько обработчиков на элемент\r\n    // Если на элементе были другие обработчики - они удаляются\r\n    // В итоге на элементе гарантировано только переданный набор обработчиков\r\n    set(elem, handler_name, event_name = this.default_event_name) {\r\n        if (!elem || !handler_name) return false;\r\n\r\n        let result = true;\r\n\r\n        // Удаляем все уже имеющиеся обработчики\r\n        this.removeAll(elem, event_name);\r\n\r\n        // Ставим нужные\r\n        if (handler_name instanceof Array) {\r\n            handler_name.forEach(name => {\r\n                this.add(elem, name, event_name);\r\n            });\r\n        } else if (typeof handler_name === 'string') {\r\n            this.add(elem, handler_name, event_name);\r\n        } else {\r\n            result = false;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    // Добавить обработчик с переданным именем на элемент\r\n    add(elem, handler_name, event_name = this.default_event_name) {\r\n        if (!elem || !handler_name || !this.getHandler(handler_name)) return false;\r\n\r\n        elem.addEventListener(event_name, this.getHandler(handler_name));\r\n\r\n        return true;\r\n    }\r\n\r\n    // Удалить обработчик с переданным именем с элемента\r\n    remove(elem, handler_name, event_name = this.default_event_name) {\r\n        if (!elem || !handler_name || !this.getHandler(handler_name)) return false;\r\n\r\n        elem.removeEventListener(event_name, this.getHandler(handler_name));\r\n\r\n        return true;\r\n    }\r\n\r\n    // Удалить все обработчики с элемента\r\n    removeAll(elem, event_name = this.default_event_name) {\r\n        if (!elem) return false;\r\n\r\n        for (let handler in this.handlers) {\r\n            elem.removeEventListener(event_name, this.getHandler(handler));\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    // Получить имена всех обработчиков\r\n    getHandlersNames() {\r\n        return Object.keys(this.handlers);\r\n    }\r\n\r\n    // Получить объект всех функций-обработчиков\r\n    getHandlers() {\r\n        return this.handlers;\r\n    }\r\n\r\n    // Получить функцию-обработчик\r\n    getHandler(handler_name) {\r\n        return this.handlers[handler_name];\r\n    }\r\n\r\n    // === Обработчики ===\r\n\r\n    _testHandler() {\r\n        alert('_testHandler');\r\n    }\r\n\r\n    // Отменяет действие браузера\r\n    _preventHandler(e) {\r\n        e.preventDefault();\r\n        return false;\r\n    }\r\n\r\n    // Останавливает всплытие, другие обработчики и отменяет действие браузера\r\n    _preventStopHandler(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        e.stopImmediatePropagation();\r\n        return false;\r\n    }\r\n\r\n    // Обработчик кнопки для режима открытия в новой вкладке\r\n    _newTabHandler() {\r\n        return true;\r\n    }\r\n\r\n    // Обработчик кнопки для режима скачивания\r\n    _downloadHandler(e) {\r\n        e.preventDefault();\r\n        Download(e.currentTarget.href);\r\n        return false;\r\n    }\r\n}","import PhotoDownloadTemplates from './templates';\r\nimport HandlersManager from './handlers';\r\n\r\nexport default class PhotoDownload {\r\n    constructor(params = {}) {\r\n        let that = this;\r\n\r\n        // Ссылка, в которую обернута картинка, \r\n        // здесь нужнв для триггера создания/обновления кнопки\r\n        this.imgContainer_id = 'pv_photo';\r\n\r\n        // Объект всех селекторов, использующихся в кнопке\r\n        this.selectors = {\r\n            // id контейнера кнопки\r\n            photoDownload_id: 'PhotoDownload',\r\n            // Контейнер, в котором находится картинка и элементы управления,\r\n            // создавать кнопку будем в нем\r\n            imgContainer_class: 'pv_image_wrap',\r\n            // id, который добавится тегу style\r\n            style_id: 'PhotoDownloadStyle',\r\n            // Класс кнопки (тега a)\r\n            PhotoDownload_btn: 'PhotoDownload_btn',\r\n            // Класс блока иконки\r\n            PhotoDownload_icon: 'PhotoDownload_icon',\r\n            // Класс блока, в котором отображается разрешение картинки\r\n            PhotoDownload_size: 'PhotoDownload_size',\r\n            // Класс-флаг, вешается на .PhotoDownload_size когда нет данных о разрешении\r\n            non_size: 'non_size',\r\n            // Класс-флаг, вешается для плавного opacity кнопки после создания\r\n            ready: 'ready',\r\n        };\r\n\r\n        // Объект с описанием обработчиков\r\n        this.triggers = {\r\n            mouseover: [\r\n                // Селектор ссылки, в которую обернута картинка в просмотрщике\r\n                {\r\n                    type: 'id',\r\n                    selector: this.imgContainer_id,\r\n                    // При наведении на контейнер картинки, будем обновлять(создавать) кнопку\r\n                    handler: this._updateBtn,\r\n                    child: true,\r\n                },\r\n                // Селектор родительского блока кнопки\r\n                {\r\n                    type: 'class',\r\n                    selector: this.selectors.PhotoDownload_btn,\r\n                    // При наведении на саму кнопку, будем обновлять в ней данные\r\n                    handler: this._updateBtn,\r\n                    child: true,\r\n                },\r\n            ], // Конец mouseover\r\n        };\r\n\r\n        // Флаг, задающий поведение клика по кнопке\r\n        // Если true, то картинка будет скачиваться\r\n        // Если false, то картинка будет открываться в новой вкладке\r\n        this.flag_download = {\r\n            _flag: params.download,\r\n            get flag() {\r\n                return this._flag;\r\n            },\r\n            set flag(val) {\r\n                if (typeof val === 'boolean') {\r\n                    this._flag = val;\r\n                    that._addBtnHandlers(this._flag);\r\n                }\r\n            }\r\n        };\r\n\r\n        // Здесь будет храниться элемент кнопки\r\n        this.wrap = null;\r\n\r\n        // Создаем инстанс шаблонизатора верстки\r\n        this.template = new PhotoDownloadTemplates({\r\n            selectors: this.selectors\r\n        });\r\n\r\n        // Создаем инстанс контроллера событий внутри кнопки\r\n        this.handlers = new HandlersManager({\r\n            PhotoDownload: this\r\n        });\r\n\r\n\r\n        // Точка входа\r\n        this.init();\r\n    }\r\n\r\n    // Добавляет на кнопку обработчики скачивания/открытия в новой вкладке\r\n    _addBtnHandlers() {\r\n        if (!this.wrap) return false;\r\n\r\n        let btn = this.wrap.querySelector('.' + this.selectors.PhotoDownload_btn);\r\n\r\n        // В зависимости от флага вешаем либо обработчик скачивания, либо открытия новой вкладки\r\n        if (this.flag_download.flag) {\r\n            this.handlers.set(btn, 'downloadHandler');\r\n        } else {\r\n            this.handlers.set(btn, 'newTabHandler');\r\n        }\r\n    }\r\n\r\n    // Метод обновления данных в кнопке\r\n    _updateBtn(elem) {\r\n        this.parent = elem.closest('.' + this.selectors.imgContainer_class);\r\n\r\n        // Если в родительском контейнере еще нет кнопки\r\n        if (!this.parent.querySelector('#' + this.selectors.photoDownload_id)) {\r\n            // то создадим ее\r\n            this.wrap = this.template.createDownloadContainer(this.parent);\r\n            // И повесим на нее обработчики\r\n            this._addBtnHandlers();\r\n        }\r\n\r\n        let btn = this.wrap.querySelector('.' + this.selectors.PhotoDownload_btn);\r\n        let size = this.wrap.querySelector('.' + this.selectors.PhotoDownload_size);\r\n\r\n        // Получаем из недр ВК информацию о максимальной версии открытой в просмотрщике картинки\r\n        let image_data = window.Photoview.genData(window.cur.pvCurPhoto);\r\n\r\n        // Если ссылка в кнопке не та, которая нужна сейчас\r\n        if (btn.href !== image_data.src) {\r\n            // Обновим ссылку в кнопке\r\n            btn.href = image_data.src;\r\n\r\n            // И размеры картинки, которая по ссылке\r\n            this.template.setSize(size, image_data);\r\n        }\r\n    }\r\n\r\n    // Проверка на то, является ли цель события дочерним элементом селектора из объекта триггеров\r\n    _checkComplianceChild(target, trigger) {\r\n        let parent = (trigger.type === 'id') ?\r\n            target.closest('#' + trigger.selector) :\r\n            target.closest('.' + trigger.selector);\r\n\r\n        if (parent) {\r\n            // Если да, запустим обработчик для родителя\r\n            this._checkComplianceTarget(parent, trigger);\r\n        }\r\n    }\r\n\r\n    // Проверка на соответствие цели события с селекторами объекта триггеров\r\n    _checkComplianceTarget(target, trigger) {\r\n        let compliance = false;\r\n\r\n        // Два отдельных условия для того, чтобы была возможность назначить\r\n        // разные обработчики по id и по классу на один элемент, и они сработали оба\r\n        if (trigger.type === 'id') {\r\n            if (target.id === trigger.selector) {\r\n                compliance = true;\r\n\r\n                if (trigger.handler) {\r\n                    trigger.handler.call(this, target);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (trigger.type === 'class') {\r\n            if (target.classList.contains(trigger.selector)) {\r\n                compliance = true;\r\n\r\n                if (trigger.handler) {\r\n                    trigger.handler.call(this, target);\r\n                }\r\n            }\r\n        }\r\n\r\n        return compliance;\r\n    }\r\n\r\n    // Метод, который вызывает нужный обработчик при нужном событии\r\n    _watchTrigger(event) {\r\n        // Смотрим, есть ли обработчики полученного типа события\r\n        // На самом деле они всегда должны быть, но все же\r\n        let triggers = this.triggers[event.type];\r\n        if (triggers === undefined) return;\r\n\r\n        // Берем элемент, на котором сработало событие\r\n        let target = event.target;\r\n\r\n        // Цикл по объекту обработчиков полученного типа события\r\n        triggers.forEach(trigger => {\r\n            // Ищем обработчик для цели события\r\n            // Если вернется false, то не найден\r\n            let compliance = this._checkComplianceTarget(target, trigger);\r\n\r\n            // Если цели события нет в объекте обработчиков, но в обработчике указано, \r\n            // что он может срабатывать на дочернем элементе\r\n            if (!compliance && trigger.child) {\r\n                // Попробуем найти родительский элемент цели, соответствующий селектору\r\n                // из объекта обработчиков\r\n                this._checkComplianceChild(target, trigger);\r\n            }\r\n        });\r\n    }\r\n\r\n    // Установка на document слушателей типов событий, имеющихся в объекте обработчиков\r\n    _initWatcher() {\r\n        let types = Object.keys(this.triggers);\r\n        types.forEach(type => document.addEventListener(type, this._watchTrigger.bind(this)))\r\n    }\r\n\r\n    // Метод добавления на страницу стилей, необходимых для работы PhotoDownload\r\n    _injectCSS() {\r\n        let style = document.createElement('style');\r\n        style.id = this.selectors.style_id;\r\n        style.textContent = this.template.getStyleContent();\r\n\r\n        document.head.appendChild(style);\r\n    }\r\n\r\n\r\n    // Точка входа\r\n    init() {\r\n        console.log('%c%s', (window.log_color) ? window.log_color.blue : '', 'PhotoDownload: Init');\r\n\r\n        // Добавляем стили PhotoDownload\r\n        this._injectCSS();\r\n\r\n        // Инициализируем обработчики глобальных событий на document\r\n        this._initWatcher();\r\n    }\r\n}","// Класс для шаблонизации верстки кнопки и ее стилей\r\nexport default class PhotoDownloadTemplates {\r\n    constructor(params = {}) {\r\n            // Переданный объект селекторов\r\n            this.selectors = params.selectors;\r\n\r\n            // Объект, генерирующий разноцветные иконки\r\n            this.icons = {\r\n                _colors: {\r\n                    green: '#00B75A',\r\n                    red: '#F92672',\r\n                    white: '#FFFFFF',\r\n                    yellow: '#FFC000',\r\n                },\r\n                _prefix: 'data:image/svg+xml;charset=utf-8,',\r\n                /* html */\r\n                _template: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\">\r\n                            <path fill=\"{{color}}\" d=\"M 4,0 4,8 0,8 8,16 16,8 12,8 12,0 4,0 z\"/>\r\n                        </svg>`,\r\n                _temp(color) {\r\n                    return this._template.replace(/\\{\\{.*\\}\\}/gm, color ? color : 'white');\r\n                },\r\n                get(color, url = true) {\r\n                    let _color = this._colors[color] ? this._colors[color] : color;\r\n                    let svg = this._temp(_color).replace(/[\\s]{2,}/gm, ' ');\r\n                    return url ? this._prefix + encodeURIComponent(svg) : svg;\r\n                }\r\n            };\r\n        } // constructor\r\n\r\n    // Метод для отображения размеров картинки в кнопке\r\n    setSize(size, image_data) {\r\n        if (image_data.width && image_data.height) {\r\n            size.classList.remove(this.selectors.non_size);\r\n            size.textContent = `${image_data.width}x${image_data.height}`;\r\n        } else {\r\n            size.classList.add(this.selectors.non_size);\r\n            size.textContent = '';\r\n        }\r\n    }\r\n\r\n    // Метод создания контейнера с кнопкой\r\n    createDownloadContainer(parent) {\r\n        let wrap = document.createElement('div');\r\n        wrap.id = this.selectors.photoDownload_id;\r\n\r\n        // Заполнение контейнера внутренними элементами\r\n        wrap.innerHTML = this.getInnerElems();\r\n\r\n        setTimeout(() => {\r\n            wrap.classList.add(this.selectors.ready);\r\n        }, 0);\r\n\r\n        parent.appendChild(wrap);\r\n\r\n        return wrap;\r\n    }\r\n\r\n    // Метод, генерирующий верстку самой кнопки\r\n    getInnerElems() {\r\n        return /* html */ `\r\n            <a class=\"${this.selectors.PhotoDownload_btn}\" href=\"#!\" target=\"_blank\" draggable=\"false\">\r\n                <div class=\"${this.selectors.PhotoDownload_icon}\"></div>\r\n                <div class=\"${this.selectors.PhotoDownload_size}\"></div>\r\n            </a>\r\n        `;\r\n    }\r\n\r\n    // Метод, шаблонизирующий стили кнопки\r\n    getStyleContent() {\r\n            return /* css */ `\r\n        #${this.selectors.photoDownload_id} {\r\n            background-color: #000;\r\n            border-top-left-radius: 4px;\r\n            position: absolute;\r\n            bottom: 0;\r\n            left: 100%;\r\n            opacity: 0;\r\n            transform: translate3d(-38px, 0, 1px);\r\n            will-change: transform, opacity;\r\n            transition: opacity .25s ease-in-out, transform .25s ease-in-out !important;\r\n        }\r\n        .${this.selectors.imgContainer_class}:hover #${this.selectors.photoDownload_id}.${this.selectors.ready} {\r\n            opacity: .3;\r\n        }\r\n        .${this.selectors.imgContainer_class} #${this.selectors.photoDownload_id}.${this.selectors.ready}:hover {\r\n            opacity: .8;\r\n            transform: translate3d(-100%, 0, 1px);\r\n        }\r\n        .${this.selectors.PhotoDownload_btn} {\r\n            display: flex;\r\n            align-items: center;\r\n            padding: 10px;\r\n        }\r\n        .${this.selectors.PhotoDownload_btn}:hover {\r\n            text-decoration: none;\r\n        }\r\n        .${this.selectors.PhotoDownload_icon} {\r\n            background-image: url('${this.icons.get('white')}');\r\n            background-size: contain;\r\n            background-repeat: no-repeat;\r\n            height: 18px;\r\n            width: 18px;\r\n        }\r\n        .${this.selectors.PhotoDownload_btn}:hover .${this.selectors.PhotoDownload_icon} {\r\n            background-image: url('${this.icons.get('green')}');\r\n        }\r\n        #${this.selectors.photoDownload_id} .${this.selectors.PhotoDownload_size}:not(.${this.selectors.non_size}) {\r\n            padding-left: 10px;\r\n            color: #C3CFE0 !important;\r\n        }\r\n        `;\r\n        } // getStyleContent\r\n\r\n}","import PhotoDownload from './modules/photo-download';\r\n\r\n\r\nwindow.photoDownload = new PhotoDownload({\r\n    download: true\r\n});","//download.js v4.2, by dandavis; 2008-2016. [MIT] see http://danml.com/download.html for tests/usage\n// v1 landed a FF+Chrome compat way of downloading strings to local un-named files, upgraded to use a hidden frame and optional mime\n// v2 added named files via a[download], msSaveBlob, IE (10+) support, and window.URL support for larger+faster saves than dataURLs\n// v3 added dataURL and Blob Input, bind-toggle arity, and legacy dataURL fallback was improved with force-download mime and base64 support. 3.1 improved safari handling.\n// v4 adds AMD/UMD, commonJS, and plain browser support\n// v4.1 adds url download capability via solo URL argument (same domain/CORS only)\n// v4.2 adds semantic variable names, long (over 2MB) dataURL support, and hidden by default temp anchors\n// https://github.com/rndme/download\n\n(function (root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine([], factory);\n\t} else if (typeof exports === 'object') {\n\t\t// Node. Does not work with strict CommonJS, but\n\t\t// only CommonJS-like environments that support module.exports,\n\t\t// like Node.\n\t\tmodule.exports = factory();\n\t} else {\n\t\t// Browser globals (root is window)\n\t\troot.download = factory();\n  }\n}(this, function () {\n\n\treturn function download(data, strFileName, strMimeType) {\n\n\t\tvar self = window, // this script is only for browsers anyway...\n\t\t\tdefaultMime = \"application/octet-stream\", // this default mime also triggers iframe downloads\n\t\t\tmimeType = strMimeType || defaultMime,\n\t\t\tpayload = data,\n\t\t\turl = !strFileName && !strMimeType && payload,\n\t\t\tanchor = document.createElement(\"a\"),\n\t\t\ttoString = function(a){return String(a);},\n\t\t\tmyBlob = (self.Blob || self.MozBlob || self.WebKitBlob || toString),\n\t\t\tfileName = strFileName || \"download\",\n\t\t\tblob,\n\t\t\treader;\n\t\t\tmyBlob= myBlob.call ? myBlob.bind(self) : Blob ;\n\t  \n\t\tif(String(this)===\"true\"){ //reverse arguments, allowing download.bind(true, \"text/xml\", \"export.xml\") to act as a callback\n\t\t\tpayload=[payload, mimeType];\n\t\t\tmimeType=payload[0];\n\t\t\tpayload=payload[1];\n\t\t}\n\n\n\t\tif(url && url.length< 2048){ // if no filename and no mime, assume a url was passed as the only argument\n\t\t\tfileName = url.split(\"/\").pop().split(\"?\")[0];\n\t\t\tanchor.href = url; // assign href prop to temp anchor\n\t\t  \tif(anchor.href.indexOf(url) !== -1){ // if the browser determines that it's a potentially valid url path:\n        \t\tvar ajax=new XMLHttpRequest();\n        \t\tajax.open( \"GET\", url, true);\n        \t\tajax.responseType = 'blob';\n        \t\tajax.onload= function(e){ \n\t\t\t\t  download(e.target.response, fileName, defaultMime);\n\t\t\t\t};\n        \t\tsetTimeout(function(){ ajax.send();}, 0); // allows setting custom ajax headers using the return:\n\t\t\t    return ajax;\n\t\t\t} // end if valid url?\n\t\t} // end if url?\n\n\n\t\t//go ahead and download dataURLs right away\n\t\tif(/^data:([\\w+-]+\\/[\\w+.-]+)?[,;]/.test(payload)){\n\t\t\n\t\t\tif(payload.length > (1024*1024*1.999) && myBlob !== toString ){\n\t\t\t\tpayload=dataUrlToBlob(payload);\n\t\t\t\tmimeType=payload.type || defaultMime;\n\t\t\t}else{\t\t\t\n\t\t\t\treturn navigator.msSaveBlob ?  // IE10 can't do a[download], only Blobs:\n\t\t\t\t\tnavigator.msSaveBlob(dataUrlToBlob(payload), fileName) :\n\t\t\t\t\tsaver(payload) ; // everyone else can save dataURLs un-processed\n\t\t\t}\n\t\t\t\n\t\t}else{//not data url, is it a string with special needs?\n\t\t\tif(/([\\x80-\\xff])/.test(payload)){\t\t\t  \n\t\t\t\tvar i=0, tempUiArr= new Uint8Array(payload.length), mx=tempUiArr.length;\n\t\t\t\tfor(i;i<mx;++i) tempUiArr[i]= payload.charCodeAt(i);\n\t\t\t \tpayload=new myBlob([tempUiArr], {type: mimeType});\n\t\t\t}\t\t  \n\t\t}\n\t\tblob = payload instanceof myBlob ?\n\t\t\tpayload :\n\t\t\tnew myBlob([payload], {type: mimeType}) ;\n\n\n\t\tfunction dataUrlToBlob(strUrl) {\n\t\t\tvar parts= strUrl.split(/[:;,]/),\n\t\t\ttype= parts[1],\n\t\t\tdecoder= parts[2] == \"base64\" ? atob : decodeURIComponent,\n\t\t\tbinData= decoder( parts.pop() ),\n\t\t\tmx= binData.length,\n\t\t\ti= 0,\n\t\t\tuiArr= new Uint8Array(mx);\n\n\t\t\tfor(i;i<mx;++i) uiArr[i]= binData.charCodeAt(i);\n\n\t\t\treturn new myBlob([uiArr], {type: type});\n\t\t }\n\n\t\tfunction saver(url, winMode){\n\n\t\t\tif ('download' in anchor) { //html5 A[download]\n\t\t\t\tanchor.href = url;\n\t\t\t\tanchor.setAttribute(\"download\", fileName);\n\t\t\t\tanchor.className = \"download-js-link\";\n\t\t\t\tanchor.innerHTML = \"downloading...\";\n\t\t\t\tanchor.style.display = \"none\";\n\t\t\t\tdocument.body.appendChild(anchor);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tanchor.click();\n\t\t\t\t\tdocument.body.removeChild(anchor);\n\t\t\t\t\tif(winMode===true){setTimeout(function(){ self.URL.revokeObjectURL(anchor.href);}, 250 );}\n\t\t\t\t}, 66);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// handle non-a[download] safari as best we can:\n\t\t\tif(/(Version)\\/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari\\//.test(navigator.userAgent)) {\n\t\t\t\tif(/^data:/.test(url))\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\n\t\t\t\tif(!window.open(url)){ // popup blocked, offer direct download:\n\t\t\t\t\tif(confirm(\"Displaying New Document\\n\\nUse Save As... to download, then click back to return to this page.\")){ location.href=url; }\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t//do iframe dataURL download (old ch+FF):\n\t\t\tvar f = document.createElement(\"iframe\");\n\t\t\tdocument.body.appendChild(f);\n\n\t\t\tif(!winMode && /^data:/.test(url)){ // force a mime that will download:\n\t\t\t\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\n\t\t\t}\n\t\t\tf.src=url;\n\t\t\tsetTimeout(function(){ document.body.removeChild(f); }, 333);\n\n\t\t}//end saver\n\n\n\n\n\t\tif (navigator.msSaveBlob) { // IE10+ : (has Blob, but not a[download] or URL)\n\t\t\treturn navigator.msSaveBlob(blob, fileName);\n\t\t}\n\n\t\tif(self.URL){ // simple fast and modern way using Blob and URL:\n\t\t\tsaver(self.URL.createObjectURL(blob), true);\n\t\t}else{\n\t\t\t// handle non-Blob()+non-URL browsers:\n\t\t\tif(typeof blob === \"string\" || blob.constructor===toString ){\n\t\t\t\ttry{\n\t\t\t\t\treturn saver( \"data:\" +  mimeType   + \";base64,\"  +  self.btoa(blob)  );\n\t\t\t\t}catch(y){\n\t\t\t\t\treturn saver( \"data:\" +  mimeType   + \",\" + encodeURIComponent(blob)  );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Blob but not URL support:\n\t\t\treader=new FileReader();\n\t\t\treader.onload=function(e){\n\t\t\t\tsaver(this.result);\n\t\t\t};\n\t\t\treader.readAsDataURL(blob);\n\t\t}\n\t\treturn true;\n\t}; /* end download() */\n}));\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHAvc2NyaXB0cy9tb2R1bGVzL2hhbmRsZXJzLmpzIiwiYXBwL3NjcmlwdHMvbW9kdWxlcy9waG90by1kb3dubG9hZC5qcyIsImFwcC9zY3JpcHRzL21vZHVsZXMvdGVtcGxhdGVzLmpzIiwiYXBwL3NjcmlwdHMvdmstcGhvdG8tZG93bmxvYWQuanMiLCJub2RlX21vZHVsZXMvZG93bmxvYWRqcy9kb3dubG9hZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7OztBQUVBO0lBQ3FCLGU7OztBQUNqQiw2QkFBeUI7QUFBQSxRQUFiLE1BQWEsdUVBQUosRUFBSTs7QUFBQTs7QUFDakI7QUFDQSxTQUFLLGFBQUwsR0FBcUIsTUFBTSxDQUFDLGFBQTVCLENBRmlCLENBSWpCOztBQUNBLFNBQUssa0JBQUwsR0FBMEIsT0FBMUIsQ0FMaUIsQ0FPakI7O0FBQ0EsU0FBSyxRQUFMLEdBQWdCO0FBQ1osTUFBQSxXQUFXLEVBQUUsS0FBSyxZQUROO0FBRVosTUFBQSxjQUFjLEVBQUUsS0FBSyxlQUZUO0FBR1osTUFBQSxrQkFBa0IsRUFBRSxLQUFLLG1CQUhiO0FBSVosTUFBQSxhQUFhLEVBQUUsS0FBSyxjQUpSO0FBS1osTUFBQSxlQUFlLEVBQUUsS0FBSztBQUxWLEtBQWhCO0FBT0gsRyxDQUFDO0FBRU47QUFDQTtBQUNBOzs7Ozt3QkFDSSxJLEVBQU0sWSxFQUFvRDtBQUFBOztBQUFBLFVBQXRDLFVBQXNDLHVFQUF6QixLQUFLLGtCQUFvQjtBQUMxRCxVQUFJLENBQUMsSUFBRCxJQUFTLENBQUMsWUFBZCxFQUE0QixPQUFPLEtBQVA7QUFFNUIsVUFBSSxNQUFNLEdBQUcsSUFBYixDQUgwRCxDQUsxRDs7QUFDQSxXQUFLLFNBQUwsQ0FBZSxJQUFmLEVBQXFCLFVBQXJCLEVBTjBELENBUTFEOztBQUNBLFVBQUksWUFBWSxZQUFZLEtBQTVCLEVBQW1D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NUY7QUFBQTtBQTBDSCxLLENBQUM7Ozs7Ozs7Ozs7OztBQ2hIVjs7OztBQUdBLE1BQU0sQ0FBQyxhQUFQLEdBQXVCLElBQUksc0JBQUosQ0FBa0I7QUFDckMsRUFBQSxRQUFRLEVBQUU7QUFEMkIsQ0FBbEIsQ0FBdkI7OztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImltcG9ydCBEb3dubG9hZCBmcm9tICdkb3dubG9hZGpzJztcclxuXHJcbi8vINCa0LvQsNGB0YEg0LTQu9GPINGD0L/RgNCw0LLQu9C10L3QuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC60LDQvNC4INCy0L3Rg9GC0YDQuCDQutC90L7Qv9C60LhcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGFuZGxlcnNNYW5hZ2VyIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmFtcyA9IHt9KSB7XHJcbiAgICAgICAgICAgIC8vINCf0LXRgNC10LTQsNC90L3Ri9C5INC40L3RgdGC0LDQvdGBINCz0LvQsNCy0L3QvtCz0L4g0LrQu9Cw0YHRgdCwXHJcbiAgICAgICAgICAgIHRoaXMuUGhvdG9Eb3dubG9hZCA9IHBhcmFtcy5QaG90b0Rvd25sb2FkO1xyXG5cclxuICAgICAgICAgICAgLy8g0KLQuNC/INGB0L7QsdGL0YLQuNGPINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOINC00LvRjyDQvtCx0YDQsNCx0L7RgtGH0LjQutC+0LJcclxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0X2V2ZW50X25hbWUgPSAnY2xpY2snO1xyXG5cclxuICAgICAgICAgICAgLy8g0J7QsdGK0LXQutGCINGBINC/0LXRgNC10YfQuNGB0LvQtdC90LjQtdC8INCy0YHQtdGFINCy0L7Qt9C80L7QttC90YvRhSDQvtCx0YDQsNCx0L7RgtGH0LjQutC+0LJcclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVycyA9IHtcclxuICAgICAgICAgICAgICAgIHRlc3RIYW5kbGVyOiB0aGlzLl90ZXN0SGFuZGxlcixcclxuICAgICAgICAgICAgICAgIHByZXZlbnRIYW5kbGVyOiB0aGlzLl9wcmV2ZW50SGFuZGxlcixcclxuICAgICAgICAgICAgICAgIHByZXZlbnRTdG9wSGFuZGxlcjogdGhpcy5fcHJldmVudFN0b3BIYW5kbGVyLFxyXG4gICAgICAgICAgICAgICAgbmV3VGFiSGFuZGxlcjogdGhpcy5fbmV3VGFiSGFuZGxlcixcclxuICAgICAgICAgICAgICAgIGRvd25sb2FkSGFuZGxlcjogdGhpcy5fZG93bmxvYWRIYW5kbGVyLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSAvLyBjb25zdHJ1Y3RvclxyXG5cclxuICAgIC8vINCj0YHRgtCw0L3QvtCy0LjRgtGMINC+0LTQuNC9INC40LvQuCDQvdC10YHQutC+0LvRjNC60L4g0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyINC90LAg0Y3Qu9C10LzQtdC90YJcclxuICAgIC8vINCV0YHQu9C4INC90LAg0Y3Qu9C10LzQtdC90YLQtSDQsdGL0LvQuCDQtNGA0YPQs9C40LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCAtINC+0L3QuCDRg9C00LDQu9GP0Y7RgtGB0Y9cclxuICAgIC8vINCSINC40YLQvtCz0LUg0L3QsCDRjdC70LXQvNC10L3RgtC1INCz0LDRgNCw0L3RgtC40YDQvtCy0LDQvdC+INGC0L7Qu9GM0LrQviDQv9C10YDQtdC00LDQvdC90YvQuSDQvdCw0LHQvtGAINC+0LHRgNCw0LHQvtGC0YfQuNC60L7QslxyXG4gICAgc2V0KGVsZW0sIGhhbmRsZXJfbmFtZSwgZXZlbnRfbmFtZSA9IHRoaXMuZGVmYXVsdF9ldmVudF9uYW1lKSB7XHJcbiAgICAgICAgaWYgKCFlbGVtIHx8ICFoYW5kbGVyX25hbWUpIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IHRydWU7XHJcblxyXG4gICAgICAgIC8vINCj0LTQsNC70Y/QtdC8INCy0YHQtSDRg9C20LUg0LjQvNC10Y7RidC40LXRgdGPINC+0LHRgNCw0LHQvtGC0YfQuNC60LhcclxuICAgICAgICB0aGlzLnJlbW92ZUFsbChlbGVtLCBldmVudF9uYW1lKTtcclxuXHJcbiAgICAgICAgLy8g0KHRgtCw0LLQuNC8INC90YPQttC90YvQtVxyXG4gICAgICAgIGlmIChoYW5kbGVyX25hbWUgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICBoYW5kbGVyX25hbWUuZm9yRWFjaChuYW1lID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkKGVsZW0sIG5hbWUsIGV2ZW50X25hbWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBoYW5kbGVyX25hbWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkKGVsZW0sIGhhbmRsZXJfbmFtZSwgZXZlbnRfbmFtZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8vINCU0L7QsdCw0LLQuNGC0Ywg0L7QsdGA0LDQsdC+0YLRh9C40Log0YEg0L/QtdGA0LXQtNCw0L3QvdGL0Lwg0LjQvNC10L3QtdC8INC90LAg0Y3Qu9C10LzQtdC90YJcclxuICAgIGFkZChlbGVtLCBoYW5kbGVyX25hbWUsIGV2ZW50X25hbWUgPSB0aGlzLmRlZmF1bHRfZXZlbnRfbmFtZSkge1xyXG4gICAgICAgIGlmICghZWxlbSB8fCAhaGFuZGxlcl9uYW1lIHx8ICF0aGlzLmdldEhhbmRsZXIoaGFuZGxlcl9uYW1lKSkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRfbmFtZSwgdGhpcy5nZXRIYW5kbGVyKGhhbmRsZXJfbmFtZSkpO1xyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDQo9C00LDQu9C40YLRjCDQvtCx0YDQsNCx0L7RgtGH0LjQuiDRgSDQv9C10YDQtdC00LDQvdC90YvQvCDQuNC80LXQvdC10Lwg0YEg0Y3Qu9C10LzQtdC90YLQsFxyXG4gICAgcmVtb3ZlKGVsZW0sIGhhbmRsZXJfbmFtZSwgZXZlbnRfbmFtZSA9IHRoaXMuZGVmYXVsdF9ldmVudF9uYW1lKSB7XHJcbiAgICAgICAgaWYgKCFlbGVtIHx8ICFoYW5kbGVyX25hbWUgfHwgIXRoaXMuZ2V0SGFuZGxlcihoYW5kbGVyX25hbWUpKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudF9uYW1lLCB0aGlzLmdldEhhbmRsZXIoaGFuZGxlcl9uYW1lKSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vINCj0LTQsNC70LjRgtGMINCy0YHQtSDQvtCx0YDQsNCx0L7RgtGH0LjQutC4INGBINGN0LvQtdC80LXQvdGC0LBcclxuICAgIHJlbW92ZUFsbChlbGVtLCBldmVudF9uYW1lID0gdGhpcy5kZWZhdWx0X2V2ZW50X25hbWUpIHtcclxuICAgICAgICBpZiAoIWVsZW0pIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaGFuZGxlciBpbiB0aGlzLmhhbmRsZXJzKSB7XHJcbiAgICAgICAgICAgIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudF9uYW1lLCB0aGlzLmdldEhhbmRsZXIoaGFuZGxlcikpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g0J/QvtC70YPRh9C40YLRjCDQuNC80LXQvdCwINCy0YHQtdGFINC+0LHRgNCw0LHQvtGC0YfQuNC60L7QslxyXG4gICAgZ2V0SGFuZGxlcnNOYW1lcygpIHtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5oYW5kbGVycyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g0J/QvtC70YPRh9C40YLRjCDQvtCx0YrQtdC60YIg0LLRgdC10YUg0YTRg9C90LrRhtC40Lkt0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyXHJcbiAgICBnZXRIYW5kbGVycygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVycztcclxuICAgIH1cclxuXHJcbiAgICAvLyDQn9C+0LvRg9GH0LjRgtGMINGE0YPQvdC60YbQuNGOLdC+0LHRgNCw0LHQvtGC0YfQuNC6XHJcbiAgICBnZXRIYW5kbGVyKGhhbmRsZXJfbmFtZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhhbmRsZXJzW2hhbmRsZXJfbmFtZV07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gPT09INCe0LHRgNCw0LHQvtGC0YfQuNC60LggPT09XHJcblxyXG4gICAgX3Rlc3RIYW5kbGVyKCkge1xyXG4gICAgICAgIGFsZXJ0KCdfdGVzdEhhbmRsZXInKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDQntGC0LzQtdC90Y/QtdGCINC00LXQudGB0YLQstC40LUg0LHRgNCw0YPQt9C10YDQsFxyXG4gICAgX3ByZXZlbnRIYW5kbGVyKGUpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vINCe0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdGCINCy0YHQv9C70YvRgtC40LUsINC00YDRg9Cz0LjQtSDQvtCx0YDQsNCx0L7RgtGH0LjQutC4INC4INC+0YLQvNC10L3Rj9C10YIg0LTQtdC50YHRgtCy0LjQtSDQsdGA0LDRg9C30LXRgNCwXHJcbiAgICBfcHJldmVudFN0b3BIYW5kbGVyKGUpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDQntCx0YDQsNCx0L7RgtGH0LjQuiDQutC90L7Qv9C60Lgg0LTQu9GPINGA0LXQttC40LzQsCDQvtGC0LrRgNGL0YLQuNGPINCyINC90L7QstC+0Lkg0LLQutC70LDQtNC60LVcclxuICAgIF9uZXdUYWJIYW5kbGVyKCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vINCe0LHRgNCw0LHQvtGC0YfQuNC6INC60L3QvtC/0LrQuCDQtNC70Y8g0YDQtdC20LjQvNCwINGB0LrQsNGH0LjQstCw0L3QuNGPXHJcbiAgICBfZG93bmxvYWRIYW5kbGVyKGUpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgRG93bmxvYWQoZS5jdXJyZW50VGFyZ2V0LmhyZWYpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufSIsImltcG9ydCBQaG90b0Rvd25sb2FkVGVtcGxhdGVzIGZyb20gJy4vdGVtcGxhdGVzJztcclxuaW1wb3J0IEhhbmRsZXJzTWFuYWdlciBmcm9tICcuL2hhbmRsZXJzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBob3RvRG93bmxvYWQge1xyXG4gICAgY29uc3RydWN0b3IocGFyYW1zID0ge30pIHtcclxuICAgICAgICBsZXQgdGhhdCA9IHRoaXM7XHJcblxyXG4gICAgICAgIC8vINCh0YHRi9C70LrQsCwg0LIg0LrQvtGC0L7RgNGD0Y4g0L7QsdC10YDQvdGD0YLQsCDQutCw0YDRgtC40L3QutCwLCBcclxuICAgICAgICAvLyDQt9C00LXRgdGMINC90YPQttC90LIg0LTQu9GPINGC0YDQuNCz0LPQtdGA0LAg0YHQvtC30LTQsNC90LjRjy/QvtCx0L3QvtCy0LvQtdC90LjRjyDQutC90L7Qv9C60LhcclxuICAgICAgICB0aGlzLmltZ0NvbnRhaW5lcl9pZCA9ICdwdl9waG90byc7XHJcblxyXG4gICAgICAgIC8vINCe0LHRitC10LrRgiDQstGB0LXRhSDRgdC10LvQtdC60YLQvtGA0L7Qsiwg0LjRgdC/0L7Qu9GM0LfRg9GO0YnQuNGF0YHRjyDQsiDQutC90L7Qv9C60LVcclxuICAgICAgICB0aGlzLnNlbGVjdG9ycyA9IHtcclxuICAgICAgICAgICAgLy8gaWQg0LrQvtC90YLQtdC50L3QtdGA0LAg0LrQvdC+0L/QutC4XHJcbiAgICAgICAgICAgIHBob3RvRG93bmxvYWRfaWQ6ICdQaG90b0Rvd25sb2FkJyxcclxuICAgICAgICAgICAgLy8g0JrQvtC90YLQtdC50L3QtdGALCDQsiDQutC+0YLQvtGA0L7QvCDQvdCw0YXQvtC00LjRgtGB0Y8g0LrQsNGA0YLQuNC90LrQsCDQuCDRjdC70LXQvNC10L3RgtGLINGD0L/RgNCw0LLQu9C10L3QuNGPLFxyXG4gICAgICAgICAgICAvLyDRgdC+0LfQtNCw0LLQsNGC0Ywg0LrQvdC+0L/QutGDINCx0YPQtNC10Lwg0LIg0L3QtdC8XHJcbiAgICAgICAgICAgIGltZ0NvbnRhaW5lcl9jbGFzczogJ3B2X2ltYWdlX3dyYXAnLFxyXG4gICAgICAgICAgICAvLyBpZCwg0LrQvtGC0L7RgNGL0Lkg0LTQvtCx0LDQstC40YLRgdGPINGC0LXQs9GDIHN0eWxlXHJcbiAgICAgICAgICAgIHN0eWxlX2lkOiAnUGhvdG9Eb3dubG9hZFN0eWxlJyxcclxuICAgICAgICAgICAgLy8g0JrQu9Cw0YHRgSDQutC90L7Qv9C60LggKNGC0LXQs9CwIGEpXHJcbiAgICAgICAgICAgIFBob3RvRG93bmxvYWRfYnRuOiAnUGhvdG9Eb3dubG9hZF9idG4nLFxyXG4gICAgICAgICAgICAvLyDQmtC70LDRgdGBINCx0LvQvtC60LAg0LjQutC+0L3QutC4XHJcbiAgICAgICAgICAgIFBob3RvRG93bmxvYWRfaWNvbjogJ1Bob3RvRG93bmxvYWRfaWNvbicsXHJcbiAgICAgICAgICAgIC8vINCa0LvQsNGB0YEg0LHQu9C+0LrQsCwg0LIg0LrQvtGC0L7RgNC+0Lwg0L7RgtC+0LHRgNCw0LbQsNC10YLRgdGPINGA0LDQt9GA0LXRiNC10L3QuNC1INC60LDRgNGC0LjQvdC60LhcclxuICAgICAgICAgICAgUGhvdG9Eb3dubG9hZF9zaXplOiAnUGhvdG9Eb3dubG9hZF9zaXplJyxcclxuICAgICAgICAgICAgLy8g0JrQu9Cw0YHRgS3RhNC70LDQsywg0LLQtdGI0LDQtdGC0YHRjyDQvdCwIC5QaG90b0Rvd25sb2FkX3NpemUg0LrQvtCz0LTQsCDQvdC10YIg0LTQsNC90L3Ri9GFINC+INGA0LDQt9GA0LXRiNC10L3QuNC4XHJcbiAgICAgICAgICAgIG5vbl9zaXplOiAnbm9uX3NpemUnLFxyXG4gICAgICAgICAgICAvLyDQmtC70LDRgdGBLdGE0LvQsNCzLCDQstC10YjQsNC10YLRgdGPINC00LvRjyDQv9C70LDQstC90L7Qs9C+IG9wYWNpdHkg0LrQvdC+0L/QutC4INC/0L7RgdC70LUg0YHQvtC30LTQsNC90LjRj1xyXG4gICAgICAgICAgICByZWFkeTogJ3JlYWR5JyxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyDQntCx0YrQtdC60YIg0YEg0L7Qv9C40YHQsNC90LjQtdC8INC+0LHRgNCw0LHQvtGC0YfQuNC60L7QslxyXG4gICAgICAgIHRoaXMudHJpZ2dlcnMgPSB7XHJcbiAgICAgICAgICAgIG1vdXNlb3ZlcjogW1xyXG4gICAgICAgICAgICAgICAgLy8g0KHQtdC70LXQutGC0L7RgCDRgdGB0YvQu9C60LgsINCyINC60L7RgtC+0YDRg9GOINC+0LHQtdGA0L3Rg9GC0LAg0LrQsNGA0YLQuNC90LrQsCDQsiDQv9GA0L7RgdC80L7RgtGA0YnQuNC60LVcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaWQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB0aGlzLmltZ0NvbnRhaW5lcl9pZCxcclxuICAgICAgICAgICAgICAgICAgICAvLyDQn9GA0Lgg0L3QsNCy0LXQtNC10L3QuNC4INC90LAg0LrQvtC90YLQtdC50L3QtdGAINC60LDRgNGC0LjQvdC60LgsINCx0YPQtNC10Lwg0L7QsdC90L7QstC70Y/RgtGMKNGB0L7Qt9C00LDQstCw0YLRjCkg0LrQvdC+0L/QutGDXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5fdXBkYXRlQnRuLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIC8vINCh0LXQu9C10LrRgtC+0YAg0YDQvtC00LjRgtC10LvRjNGB0LrQvtCz0L4g0LHQu9C+0LrQsCDQutC90L7Qv9C60LhcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY2xhc3MnLFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiB0aGlzLnNlbGVjdG9ycy5QaG90b0Rvd25sb2FkX2J0bixcclxuICAgICAgICAgICAgICAgICAgICAvLyDQn9GA0Lgg0L3QsNCy0LXQtNC10L3QuNC4INC90LAg0YHQsNC80YMg0LrQvdC+0L/QutGDLCDQsdGD0LTQtdC8INC+0LHQvdC+0LLQu9GP0YLRjCDQsiDQvdC10Lkg0LTQsNC90L3Ri9C1XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5fdXBkYXRlQnRuLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXSwgLy8g0JrQvtC90LXRhiBtb3VzZW92ZXJcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyDQpNC70LDQsywg0LfQsNC00LDRjtGJ0LjQuSDQv9C+0LLQtdC00LXQvdC40LUg0LrQu9C40LrQsCDQv9C+INC60L3QvtC/0LrQtVxyXG4gICAgICAgIC8vINCV0YHQu9C4IHRydWUsINGC0L4g0LrQsNGA0YLQuNC90LrQsCDQsdGD0LTQtdGCINGB0LrQsNGH0LjQstCw0YLRjNGB0Y9cclxuICAgICAgICAvLyDQldGB0LvQuCBmYWxzZSwg0YLQviDQutCw0YDRgtC40L3QutCwINCx0YPQtNC10YIg0L7RgtC60YDRi9Cy0LDRgtGM0YHRjyDQsiDQvdC+0LLQvtC5INCy0LrQu9Cw0LTQutC1XHJcbiAgICAgICAgdGhpcy5mbGFnX2Rvd25sb2FkID0ge1xyXG4gICAgICAgICAgICBfZmxhZzogcGFyYW1zLmRvd25sb2FkLFxyXG4gICAgICAgICAgICBnZXQgZmxhZygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mbGFnO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXQgZmxhZyh2YWwpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9mbGFnID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX2FkZEJ0bkhhbmRsZXJzKHRoaXMuX2ZsYWcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8g0JfQtNC10YHRjCDQsdGD0LTQtdGCINGF0YDQsNC90LjRgtGM0YHRjyDRjdC70LXQvNC10L3RgiDQutC90L7Qv9C60LhcclxuICAgICAgICB0aGlzLndyYXAgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyDQodC+0LfQtNCw0LXQvCDQuNC90YHRgtCw0L3RgSDRiNCw0LHQu9C+0L3QuNC30LDRgtC+0YDQsCDQstC10YDRgdGC0LrQuFxyXG4gICAgICAgIHRoaXMudGVtcGxhdGUgPSBuZXcgUGhvdG9Eb3dubG9hZFRlbXBsYXRlcyh7XHJcbiAgICAgICAgICAgIHNlbGVjdG9yczogdGhpcy5zZWxlY3RvcnNcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8g0KHQvtC30LTQsNC10Lwg0LjQvdGB0YLQsNC90YEg0LrQvtC90YLRgNC+0LvQu9C10YDQsCDRgdC+0LHRi9GC0LjQuSDQstC90YPRgtGA0Lgg0LrQvdC+0L/QutC4XHJcbiAgICAgICAgdGhpcy5oYW5kbGVycyA9IG5ldyBIYW5kbGVyc01hbmFnZXIoe1xyXG4gICAgICAgICAgICBQaG90b0Rvd25sb2FkOiB0aGlzXHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAvLyDQotC+0YfQutCwINCy0YXQvtC00LBcclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDQlNC+0LHQsNCy0LvRj9C10YIg0L3QsCDQutC90L7Qv9C60YMg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDRgdC60LDRh9C40LLQsNC90LjRjy/QvtGC0LrRgNGL0YLQuNGPINCyINC90L7QstC+0Lkg0LLQutC70LDQtNC60LVcclxuICAgIF9hZGRCdG5IYW5kbGVycygpIHtcclxuICAgICAgICBpZiAoIXRoaXMud3JhcCkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgYnRuID0gdGhpcy53cmFwLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWxlY3RvcnMuUGhvdG9Eb3dubG9hZF9idG4pO1xyXG5cclxuICAgICAgICAvLyDQkiDQt9Cw0LLQuNGB0LjQvNC+0YHRgtC4INC+0YIg0YTQu9Cw0LPQsCDQstC10YjQsNC10Lwg0LvQuNCx0L4g0L7QsdGA0LDQsdC+0YLRh9C40Log0YHQutCw0YfQuNCy0LDQvdC40Y8sINC70LjQsdC+INC+0YLQutGA0YvRgtC40Y8g0L3QvtCy0L7QuSDQstC60LvQsNC00LrQuFxyXG4gICAgICAgIGlmICh0aGlzLmZsYWdfZG93bmxvYWQuZmxhZykge1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZXJzLnNldChidG4sICdkb3dubG9hZEhhbmRsZXInKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZXJzLnNldChidG4sICduZXdUYWJIYW5kbGVyJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vINCc0LXRgtC+0LQg0L7QsdC90L7QstC70LXQvdC40Y8g0LTQsNC90L3Ri9GFINCyINC60L3QvtC/0LrQtVxyXG4gICAgX3VwZGF0ZUJ0bihlbGVtKSB7XHJcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBlbGVtLmNsb3Nlc3QoJy4nICsgdGhpcy5zZWxlY3RvcnMuaW1nQ29udGFpbmVyX2NsYXNzKTtcclxuXHJcbiAgICAgICAgLy8g0JXRgdC70Lgg0LIg0YDQvtC00LjRgtC10LvRjNGB0LrQvtC8INC60L7QvdGC0LXQudC90LXRgNC1INC10YnQtSDQvdC10YIg0LrQvdC+0L/QutC4XHJcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHRoaXMuc2VsZWN0b3JzLnBob3RvRG93bmxvYWRfaWQpKSB7XHJcbiAgICAgICAgICAgIC8vINGC0L4g0YHQvtC30LTQsNC00LjQvCDQtdC1XHJcbiAgICAgICAgICAgIHRoaXMud3JhcCA9IHRoaXMudGVtcGxhdGUuY3JlYXRlRG93bmxvYWRDb250YWluZXIodGhpcy5wYXJlbnQpO1xyXG4gICAgICAgICAgICAvLyDQmCDQv9C+0LLQtdGB0LjQvCDQvdCwINC90LXQtSDQvtCx0YDQsNCx0L7RgtGH0LjQutC4XHJcbiAgICAgICAgICAgIHRoaXMuX2FkZEJ0bkhhbmRsZXJzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgYnRuID0gdGhpcy53cmFwLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWxlY3RvcnMuUGhvdG9Eb3dubG9hZF9idG4pO1xyXG4gICAgICAgIGxldCBzaXplID0gdGhpcy53cmFwLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWxlY3RvcnMuUGhvdG9Eb3dubG9hZF9zaXplKTtcclxuXHJcbiAgICAgICAgLy8g0J/QvtC70YPRh9Cw0LXQvCDQuNC3INC90LXQtNGAINCS0Jog0LjQvdGE0L7RgNC80LDRhtC40Y4g0L4g0LzQsNC60YHQuNC80LDQu9GM0L3QvtC5INCy0LXRgNGB0LjQuCDQvtGC0LrRgNGL0YLQvtC5INCyINC/0YDQvtGB0LzQvtGC0YDRidC40LrQtSDQutCw0YDRgtC40L3QutC4XHJcbiAgICAgICAgbGV0IGltYWdlX2RhdGEgPSB3aW5kb3cuUGhvdG92aWV3LmdlbkRhdGEod2luZG93LmN1ci5wdkN1clBob3RvKTtcclxuXHJcbiAgICAgICAgLy8g0JXRgdC70Lgg0YHRgdGL0LvQutCwINCyINC60L3QvtC/0LrQtSDQvdC1INGC0LAsINC60L7RgtC+0YDQsNGPINC90YPQttC90LAg0YHQtdC50YfQsNGBXHJcbiAgICAgICAgaWYgKGJ0bi5ocmVmICE9PSBpbWFnZV9kYXRhLnNyYykge1xyXG4gICAgICAgICAgICAvLyDQntCx0L3QvtCy0LjQvCDRgdGB0YvQu9C60YMg0LIg0LrQvdC+0L/QutC1XHJcbiAgICAgICAgICAgIGJ0bi5ocmVmID0gaW1hZ2VfZGF0YS5zcmM7XHJcblxyXG4gICAgICAgICAgICAvLyDQmCDRgNCw0LfQvNC10YDRiyDQutCw0YDRgtC40L3QutC4LCDQutC+0YLQvtGA0LDRjyDQv9C+INGB0YHRi9C70LrQtVxyXG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlLnNldFNpemUoc2l6ZSwgaW1hZ2VfZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vINCf0YDQvtCy0LXRgNC60LAg0L3QsCDRgtC+LCDRj9Cy0LvRj9C10YLRgdGPINC70Lgg0YbQtdC70Ywg0YHQvtCx0YvRgtC40Y8g0LTQvtGH0LXRgNC90LjQvCDRjdC70LXQvNC10L3RgtC+0Lwg0YHQtdC70LXQutGC0L7RgNCwINC40Lcg0L7QsdGK0LXQutGC0LAg0YLRgNC40LPQs9C10YDQvtCyXHJcbiAgICBfY2hlY2tDb21wbGlhbmNlQ2hpbGQodGFyZ2V0LCB0cmlnZ2VyKSB7XHJcbiAgICAgICAgbGV0IHBhcmVudCA9ICh0cmlnZ2VyLnR5cGUgPT09ICdpZCcpID9cclxuICAgICAgICAgICAgdGFyZ2V0LmNsb3Nlc3QoJyMnICsgdHJpZ2dlci5zZWxlY3RvcikgOlxyXG4gICAgICAgICAgICB0YXJnZXQuY2xvc2VzdCgnLicgKyB0cmlnZ2VyLnNlbGVjdG9yKTtcclxuXHJcbiAgICAgICAgaWYgKHBhcmVudCkge1xyXG4gICAgICAgICAgICAvLyDQldGB0LvQuCDQtNCwLCDQt9Cw0L/Rg9GB0YLQuNC8INC+0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDRgNC+0LTQuNGC0LXQu9GPXHJcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrQ29tcGxpYW5jZVRhcmdldChwYXJlbnQsIHRyaWdnZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDQn9GA0L7QstC10YDQutCwINC90LAg0YHQvtC+0YLQstC10YLRgdGC0LLQuNC1INGG0LXQu9C4INGB0L7QsdGL0YLQuNGPINGBINGB0LXQu9C10LrRgtC+0YDQsNC80Lgg0L7QsdGK0LXQutGC0LAg0YLRgNC40LPQs9C10YDQvtCyXHJcbiAgICBfY2hlY2tDb21wbGlhbmNlVGFyZ2V0KHRhcmdldCwgdHJpZ2dlcikge1xyXG4gICAgICAgIGxldCBjb21wbGlhbmNlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIC8vINCU0LLQsCDQvtGC0LTQtdC70YzQvdGL0YUg0YPRgdC70L7QstC40Y8g0LTQu9GPINGC0L7Qs9C+LCDRh9GC0L7QsdGLINCx0YvQu9CwINCy0L7Qt9C80L7QttC90L7RgdGC0Ywg0L3QsNC30L3QsNGH0LjRgtGMXHJcbiAgICAgICAgLy8g0YDQsNC30L3Ri9C1INC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0L/QviBpZCDQuCDQv9C+INC60LvQsNGB0YHRgyDQvdCwINC+0LTQuNC9INGN0LvQtdC80LXQvdGCLCDQuCDQvtC90Lgg0YHRgNCw0LHQvtGC0LDQu9C4INC+0LHQsFxyXG4gICAgICAgIGlmICh0cmlnZ2VyLnR5cGUgPT09ICdpZCcpIHtcclxuICAgICAgICAgICAgaWYgKHRhcmdldC5pZCA9PT0gdHJpZ2dlci5zZWxlY3Rvcikge1xyXG4gICAgICAgICAgICAgICAgY29tcGxpYW5jZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRyaWdnZXIuaGFuZGxlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXIuaGFuZGxlci5jYWxsKHRoaXMsIHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0cmlnZ2VyLnR5cGUgPT09ICdjbGFzcycpIHtcclxuICAgICAgICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnModHJpZ2dlci5zZWxlY3RvcikpIHtcclxuICAgICAgICAgICAgICAgIGNvbXBsaWFuY2UgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0cmlnZ2VyLmhhbmRsZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyLmhhbmRsZXIuY2FsbCh0aGlzLCB0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gY29tcGxpYW5jZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDQnNC10YLQvtC0LCDQutC+0YLQvtGA0YvQuSDQstGL0LfRi9Cy0LDQtdGCINC90YPQttC90YvQuSDQvtCx0YDQsNCx0L7RgtGH0LjQuiDQv9GA0Lgg0L3Rg9C20L3QvtC8INGB0L7QsdGL0YLQuNC4XHJcbiAgICBfd2F0Y2hUcmlnZ2VyKGV2ZW50KSB7XHJcbiAgICAgICAgLy8g0KHQvNC+0YLRgNC40LwsINC10YHRgtGMINC70Lgg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDQv9C+0LvRg9GH0LXQvdC90L7Qs9C+INGC0LjQv9CwINGB0L7QsdGL0YLQuNGPXHJcbiAgICAgICAgLy8g0J3QsCDRgdCw0LzQvtC8INC00LXQu9C1INC+0L3QuCDQstGB0LXQs9C00LAg0LTQvtC70LbQvdGLINCx0YvRgtGMLCDQvdC+INCy0YHQtSDQttC1XHJcbiAgICAgICAgbGV0IHRyaWdnZXJzID0gdGhpcy50cmlnZ2Vyc1tldmVudC50eXBlXTtcclxuICAgICAgICBpZiAodHJpZ2dlcnMgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAvLyDQkdC10YDQtdC8INGN0LvQtdC80LXQvdGCLCDQvdCwINC60L7RgtC+0YDQvtC8INGB0YDQsNCx0L7RgtCw0LvQviDRgdC+0LHRi9GC0LjQtVxyXG4gICAgICAgIGxldCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XHJcblxyXG4gICAgICAgIC8vINCm0LjQutC7INC/0L4g0L7QsdGK0LXQutGC0YMg0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyINC/0L7Qu9GD0YfQtdC90L3QvtCz0L4g0YLQuNC/0LAg0YHQvtCx0YvRgtC40Y9cclxuICAgICAgICB0cmlnZ2Vycy5mb3JFYWNoKHRyaWdnZXIgPT4ge1xyXG4gICAgICAgICAgICAvLyDQmNGJ0LXQvCDQvtCx0YDQsNCx0L7RgtGH0LjQuiDQtNC70Y8g0YbQtdC70Lgg0YHQvtCx0YvRgtC40Y9cclxuICAgICAgICAgICAgLy8g0JXRgdC70Lgg0LLQtdGA0L3QtdGC0YHRjyBmYWxzZSwg0YLQviDQvdC1INC90LDQudC00LXQvVxyXG4gICAgICAgICAgICBsZXQgY29tcGxpYW5jZSA9IHRoaXMuX2NoZWNrQ29tcGxpYW5jZVRhcmdldCh0YXJnZXQsIHRyaWdnZXIpO1xyXG5cclxuICAgICAgICAgICAgLy8g0JXRgdC70Lgg0YbQtdC70Lgg0YHQvtCx0YvRgtC40Y8g0L3QtdGCINCyINC+0LHRitC10LrRgtC1INC+0LHRgNCw0LHQvtGC0YfQuNC60L7Qsiwg0L3QviDQsiDQvtCx0YDQsNCx0L7RgtGH0LjQutC1INGD0LrQsNC30LDQvdC+LCBcclxuICAgICAgICAgICAgLy8g0YfRgtC+INC+0L0g0LzQvtC20LXRgiDRgdGA0LDQsdCw0YLRi9Cy0LDRgtGMINC90LAg0LTQvtGH0LXRgNC90LXQvCDRjdC70LXQvNC10L3RgtC1XHJcbiAgICAgICAgICAgIGlmICghY29tcGxpYW5jZSAmJiB0cmlnZ2VyLmNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDQn9C+0L/RgNC+0LHRg9C10Lwg0L3QsNC50YLQuCDRgNC+0LTQuNGC0LXQu9GM0YHQutC40Lkg0Y3Qu9C10LzQtdC90YIg0YbQtdC70LgsINGB0L7QvtGC0LLQtdGC0YHRgtCy0YPRjtGJ0LjQuSDRgdC10LvQtdC60YLQvtGA0YNcclxuICAgICAgICAgICAgICAgIC8vINC40Lcg0L7QsdGK0LXQutGC0LAg0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0NvbXBsaWFuY2VDaGlsZCh0YXJnZXQsIHRyaWdnZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g0KPRgdGC0LDQvdC+0LLQutCwINC90LAgZG9jdW1lbnQg0YHQu9GD0YjQsNGC0LXQu9C10Lkg0YLQuNC/0L7QsiDRgdC+0LHRi9GC0LjQuSwg0LjQvNC10Y7RidC40YXRgdGPINCyINC+0LHRitC10LrRgtC1INC+0LHRgNCw0LHQvtGC0YfQuNC60L7QslxyXG4gICAgX2luaXRXYXRjaGVyKCkge1xyXG4gICAgICAgIGxldCB0eXBlcyA9IE9iamVjdC5rZXlzKHRoaXMudHJpZ2dlcnMpO1xyXG4gICAgICAgIHR5cGVzLmZvckVhY2godHlwZSA9PiBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIHRoaXMuX3dhdGNoVHJpZ2dlci5iaW5kKHRoaXMpKSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDQnNC10YLQvtC0INC00L7QsdCw0LLQu9C10L3QuNGPINC90LAg0YHRgtGA0LDQvdC40YbRgyDRgdGC0LjQu9C10LksINC90LXQvtCx0YXQvtC00LjQvNGL0YUg0LTQu9GPINGA0LDQsdC+0YLRiyBQaG90b0Rvd25sb2FkXHJcbiAgICBfaW5qZWN0Q1NTKCkge1xyXG4gICAgICAgIGxldCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XHJcbiAgICAgICAgc3R5bGUuaWQgPSB0aGlzLnNlbGVjdG9ycy5zdHlsZV9pZDtcclxuICAgICAgICBzdHlsZS50ZXh0Q29udGVudCA9IHRoaXMudGVtcGxhdGUuZ2V0U3R5bGVDb250ZW50KCk7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyDQotC+0YfQutCwINCy0YXQvtC00LBcclxuICAgIGluaXQoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJyVjJXMnLCAod2luZG93LmxvZ19jb2xvcikgPyB3aW5kb3cubG9nX2NvbG9yLmJsdWUgOiAnJywgJ1Bob3RvRG93bmxvYWQ6IEluaXQnKTtcclxuXHJcbiAgICAgICAgLy8g0JTQvtCx0LDQstC70Y/QtdC8INGB0YLQuNC70LggUGhvdG9Eb3dubG9hZFxyXG4gICAgICAgIHRoaXMuX2luamVjdENTUygpO1xyXG5cclxuICAgICAgICAvLyDQmNC90LjRhtC40LDQu9C40LfQuNGA0YPQtdC8INC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0LPQu9C+0LHQsNC70YzQvdGL0YUg0YHQvtCx0YvRgtC40Lkg0L3QsCBkb2N1bWVudFxyXG4gICAgICAgIHRoaXMuX2luaXRXYXRjaGVyKCk7XHJcbiAgICB9XHJcbn0iLCIvLyDQmtC70LDRgdGBINC00LvRjyDRiNCw0LHQu9C+0L3QuNC30LDRhtC40Lgg0LLQtdGA0YHRgtC60Lgg0LrQvdC+0L/QutC4INC4INC10LUg0YHRgtC40LvQtdC5XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBob3RvRG93bmxvYWRUZW1wbGF0ZXMge1xyXG4gICAgY29uc3RydWN0b3IocGFyYW1zID0ge30pIHtcclxuICAgICAgICAgICAgLy8g0J/QtdGA0LXQtNCw0L3QvdGL0Lkg0L7QsdGK0LXQutGCINGB0LXQu9C10LrRgtC+0YDQvtCyXHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JzID0gcGFyYW1zLnNlbGVjdG9ycztcclxuXHJcbiAgICAgICAgICAgIC8vINCe0LHRitC10LrRgiwg0LPQtdC90LXRgNC40YDRg9GO0YnQuNC5INGA0LDQt9C90L7RhtCy0LXRgtC90YvQtSDQuNC60L7QvdC60LhcclxuICAgICAgICAgICAgdGhpcy5pY29ucyA9IHtcclxuICAgICAgICAgICAgICAgIF9jb2xvcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBncmVlbjogJyMwMEI3NUEnLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZDogJyNGOTI2NzInLFxyXG4gICAgICAgICAgICAgICAgICAgIHdoaXRlOiAnI0ZGRkZGRicsXHJcbiAgICAgICAgICAgICAgICAgICAgeWVsbG93OiAnI0ZGQzAwMCcsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgX3ByZWZpeDogJ2RhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04LCcsXHJcbiAgICAgICAgICAgICAgICAvKiBodG1sICovXHJcbiAgICAgICAgICAgICAgICBfdGVtcGxhdGU6IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTZcIiB2ZXJzaW9uPVwiMS4xXCIgdmlld0JveD1cIjAgMCAxNiAxNlwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZmlsbD1cInt7Y29sb3J9fVwiIGQ9XCJNIDQsMCA0LDggMCw4IDgsMTYgMTYsOCAxMiw4IDEyLDAgNCwwIHpcIi8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPmAsXHJcbiAgICAgICAgICAgICAgICBfdGVtcChjb2xvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZW1wbGF0ZS5yZXBsYWNlKC9cXHtcXHsuKlxcfVxcfS9nbSwgY29sb3IgPyBjb2xvciA6ICd3aGl0ZScpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGdldChjb2xvciwgdXJsID0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBfY29sb3IgPSB0aGlzLl9jb2xvcnNbY29sb3JdID8gdGhpcy5fY29sb3JzW2NvbG9yXSA6IGNvbG9yO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdmcgPSB0aGlzLl90ZW1wKF9jb2xvcikucmVwbGFjZSgvW1xcc117Mix9L2dtLCAnICcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmwgPyB0aGlzLl9wcmVmaXggKyBlbmNvZGVVUklDb21wb25lbnQoc3ZnKSA6IHN2ZztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IC8vIGNvbnN0cnVjdG9yXHJcblxyXG4gICAgLy8g0JzQtdGC0L7QtCDQtNC70Y8g0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDRgNCw0LfQvNC10YDQvtCyINC60LDRgNGC0LjQvdC60Lgg0LIg0LrQvdC+0L/QutC1XHJcbiAgICBzZXRTaXplKHNpemUsIGltYWdlX2RhdGEpIHtcclxuICAgICAgICBpZiAoaW1hZ2VfZGF0YS53aWR0aCAmJiBpbWFnZV9kYXRhLmhlaWdodCkge1xyXG4gICAgICAgICAgICBzaXplLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5zZWxlY3RvcnMubm9uX3NpemUpO1xyXG4gICAgICAgICAgICBzaXplLnRleHRDb250ZW50ID0gYCR7aW1hZ2VfZGF0YS53aWR0aH14JHtpbWFnZV9kYXRhLmhlaWdodH1gO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNpemUuY2xhc3NMaXN0LmFkZCh0aGlzLnNlbGVjdG9ycy5ub25fc2l6ZSk7XHJcbiAgICAgICAgICAgIHNpemUudGV4dENvbnRlbnQgPSAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g0JzQtdGC0L7QtCDRgdC+0LfQtNCw0L3QuNGPINC60L7QvdGC0LXQudC90LXRgNCwINGBINC60L3QvtC/0LrQvtC5XHJcbiAgICBjcmVhdGVEb3dubG9hZENvbnRhaW5lcihwYXJlbnQpIHtcclxuICAgICAgICBsZXQgd3JhcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHdyYXAuaWQgPSB0aGlzLnNlbGVjdG9ycy5waG90b0Rvd25sb2FkX2lkO1xyXG5cclxuICAgICAgICAvLyDQl9Cw0L/QvtC70L3QtdC90LjQtSDQutC+0L3RgtC10LnQvdC10YDQsCDQstC90YPRgtGA0LXQvdC90LjQvNC4INGN0LvQtdC80LXQvdGC0LDQvNC4XHJcbiAgICAgICAgd3JhcC5pbm5lckhUTUwgPSB0aGlzLmdldElubmVyRWxlbXMoKTtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHdyYXAuY2xhc3NMaXN0LmFkZCh0aGlzLnNlbGVjdG9ycy5yZWFkeSk7XHJcbiAgICAgICAgfSwgMCk7XHJcblxyXG4gICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZCh3cmFwKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHdyYXA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g0JzQtdGC0L7QtCwg0LPQtdC90LXRgNC40YDRg9GO0YnQuNC5INCy0LXRgNGB0YLQutGDINGB0LDQvNC+0Lkg0LrQvdC+0L/QutC4XHJcbiAgICBnZXRJbm5lckVsZW1zKCkge1xyXG4gICAgICAgIHJldHVybiAvKiBodG1sICovIGBcclxuICAgICAgICAgICAgPGEgY2xhc3M9XCIke3RoaXMuc2VsZWN0b3JzLlBob3RvRG93bmxvYWRfYnRufVwiIGhyZWY9XCIjIVwiIHRhcmdldD1cIl9ibGFua1wiIGRyYWdnYWJsZT1cImZhbHNlXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiJHt0aGlzLnNlbGVjdG9ycy5QaG90b0Rvd25sb2FkX2ljb259XCI+PC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiJHt0aGlzLnNlbGVjdG9ycy5QaG90b0Rvd25sb2FkX3NpemV9XCI+PC9kaXY+XHJcbiAgICAgICAgICAgIDwvYT5cclxuICAgICAgICBgO1xyXG4gICAgfVxyXG5cclxuICAgIC8vINCc0LXRgtC+0LQsINGI0LDQsdC70L7QvdC40LfQuNGA0YPRjtGJ0LjQuSDRgdGC0LjQu9C4INC60L3QvtC/0LrQuFxyXG4gICAgZ2V0U3R5bGVDb250ZW50KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gLyogY3NzICovIGBcclxuICAgICAgICAjJHt0aGlzLnNlbGVjdG9ycy5waG90b0Rvd25sb2FkX2lkfSB7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDA7XHJcbiAgICAgICAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDRweDtcclxuICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgICAgICAgICBib3R0b206IDA7XHJcbiAgICAgICAgICAgIGxlZnQ6IDEwMCU7XHJcbiAgICAgICAgICAgIG9wYWNpdHk6IDA7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlM2QoLTM4cHgsIDAsIDFweCk7XHJcbiAgICAgICAgICAgIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm0sIG9wYWNpdHk7XHJcbiAgICAgICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgLjI1cyBlYXNlLWluLW91dCwgdHJhbnNmb3JtIC4yNXMgZWFzZS1pbi1vdXQgIWltcG9ydGFudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLiR7dGhpcy5zZWxlY3RvcnMuaW1nQ29udGFpbmVyX2NsYXNzfTpob3ZlciAjJHt0aGlzLnNlbGVjdG9ycy5waG90b0Rvd25sb2FkX2lkfS4ke3RoaXMuc2VsZWN0b3JzLnJlYWR5fSB7XHJcbiAgICAgICAgICAgIG9wYWNpdHk6IC4zO1xyXG4gICAgICAgIH1cclxuICAgICAgICAuJHt0aGlzLnNlbGVjdG9ycy5pbWdDb250YWluZXJfY2xhc3N9ICMke3RoaXMuc2VsZWN0b3JzLnBob3RvRG93bmxvYWRfaWR9LiR7dGhpcy5zZWxlY3RvcnMucmVhZHl9OmhvdmVyIHtcclxuICAgICAgICAgICAgb3BhY2l0eTogLjg7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlM2QoLTEwMCUsIDAsIDFweCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC4ke3RoaXMuc2VsZWN0b3JzLlBob3RvRG93bmxvYWRfYnRufSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICAgICAgICAgIHBhZGRpbmc6IDEwcHg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC4ke3RoaXMuc2VsZWN0b3JzLlBob3RvRG93bmxvYWRfYnRufTpob3ZlciB7XHJcbiAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLiR7dGhpcy5zZWxlY3RvcnMuUGhvdG9Eb3dubG9hZF9pY29ufSB7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnJHt0aGlzLmljb25zLmdldCgnd2hpdGUnKX0nKTtcclxuICAgICAgICAgICAgYmFja2dyb3VuZC1zaXplOiBjb250YWluO1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xyXG4gICAgICAgICAgICBoZWlnaHQ6IDE4cHg7XHJcbiAgICAgICAgICAgIHdpZHRoOiAxOHB4O1xyXG4gICAgICAgIH1cclxuICAgICAgICAuJHt0aGlzLnNlbGVjdG9ycy5QaG90b0Rvd25sb2FkX2J0bn06aG92ZXIgLiR7dGhpcy5zZWxlY3RvcnMuUGhvdG9Eb3dubG9hZF9pY29ufSB7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnJHt0aGlzLmljb25zLmdldCgnZ3JlZW4nKX0nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgIyR7dGhpcy5zZWxlY3RvcnMucGhvdG9Eb3dubG9hZF9pZH0gLiR7dGhpcy5zZWxlY3RvcnMuUGhvdG9Eb3dubG9hZF9zaXplfTpub3QoLiR7dGhpcy5zZWxlY3RvcnMubm9uX3NpemV9KSB7XHJcbiAgICAgICAgICAgIHBhZGRpbmctbGVmdDogMTBweDtcclxuICAgICAgICAgICAgY29sb3I6ICNDM0NGRTAgIWltcG9ydGFudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgYDtcclxuICAgICAgICB9IC8vIGdldFN0eWxlQ29udGVudFxyXG5cclxufSIsImltcG9ydCBQaG90b0Rvd25sb2FkIGZyb20gJy4vbW9kdWxlcy9waG90by1kb3dubG9hZCc7XHJcblxyXG5cclxud2luZG93LnBob3RvRG93bmxvYWQgPSBuZXcgUGhvdG9Eb3dubG9hZCh7XHJcbiAgICBkb3dubG9hZDogdHJ1ZVxyXG59KTsiLCIvL2Rvd25sb2FkLmpzIHY0LjIsIGJ5IGRhbmRhdmlzOyAyMDA4LTIwMTYuIFtNSVRdIHNlZSBodHRwOi8vZGFubWwuY29tL2Rvd25sb2FkLmh0bWwgZm9yIHRlc3RzL3VzYWdlXG4vLyB2MSBsYW5kZWQgYSBGRitDaHJvbWUgY29tcGF0IHdheSBvZiBkb3dubG9hZGluZyBzdHJpbmdzIHRvIGxvY2FsIHVuLW5hbWVkIGZpbGVzLCB1cGdyYWRlZCB0byB1c2UgYSBoaWRkZW4gZnJhbWUgYW5kIG9wdGlvbmFsIG1pbWVcbi8vIHYyIGFkZGVkIG5hbWVkIGZpbGVzIHZpYSBhW2Rvd25sb2FkXSwgbXNTYXZlQmxvYiwgSUUgKDEwKykgc3VwcG9ydCwgYW5kIHdpbmRvdy5VUkwgc3VwcG9ydCBmb3IgbGFyZ2VyK2Zhc3RlciBzYXZlcyB0aGFuIGRhdGFVUkxzXG4vLyB2MyBhZGRlZCBkYXRhVVJMIGFuZCBCbG9iIElucHV0LCBiaW5kLXRvZ2dsZSBhcml0eSwgYW5kIGxlZ2FjeSBkYXRhVVJMIGZhbGxiYWNrIHdhcyBpbXByb3ZlZCB3aXRoIGZvcmNlLWRvd25sb2FkIG1pbWUgYW5kIGJhc2U2NCBzdXBwb3J0LiAzLjEgaW1wcm92ZWQgc2FmYXJpIGhhbmRsaW5nLlxuLy8gdjQgYWRkcyBBTUQvVU1ELCBjb21tb25KUywgYW5kIHBsYWluIGJyb3dzZXIgc3VwcG9ydFxuLy8gdjQuMSBhZGRzIHVybCBkb3dubG9hZCBjYXBhYmlsaXR5IHZpYSBzb2xvIFVSTCBhcmd1bWVudCAoc2FtZSBkb21haW4vQ09SUyBvbmx5KVxuLy8gdjQuMiBhZGRzIHNlbWFudGljIHZhcmlhYmxlIG5hbWVzLCBsb25nIChvdmVyIDJNQikgZGF0YVVSTCBzdXBwb3J0LCBhbmQgaGlkZGVuIGJ5IGRlZmF1bHQgdGVtcCBhbmNob3JzXG4vLyBodHRwczovL2dpdGh1Yi5jb20vcm5kbWUvZG93bmxvYWRcblxuKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG5cdGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0fSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcblx0XHQvLyBOb2RlLiBEb2VzIG5vdCB3b3JrIHdpdGggc3RyaWN0IENvbW1vbkpTLCBidXRcblx0XHQvLyBvbmx5IENvbW1vbkpTLWxpa2UgZW52aXJvbm1lbnRzIHRoYXQgc3VwcG9ydCBtb2R1bGUuZXhwb3J0cyxcblx0XHQvLyBsaWtlIE5vZGUuXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdH0gZWxzZSB7XG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzIChyb290IGlzIHdpbmRvdylcblx0XHRyb290LmRvd25sb2FkID0gZmFjdG9yeSgpO1xuICB9XG59KHRoaXMsIGZ1bmN0aW9uICgpIHtcblxuXHRyZXR1cm4gZnVuY3Rpb24gZG93bmxvYWQoZGF0YSwgc3RyRmlsZU5hbWUsIHN0ck1pbWVUeXBlKSB7XG5cblx0XHR2YXIgc2VsZiA9IHdpbmRvdywgLy8gdGhpcyBzY3JpcHQgaXMgb25seSBmb3IgYnJvd3NlcnMgYW55d2F5Li4uXG5cdFx0XHRkZWZhdWx0TWltZSA9IFwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCIsIC8vIHRoaXMgZGVmYXVsdCBtaW1lIGFsc28gdHJpZ2dlcnMgaWZyYW1lIGRvd25sb2Fkc1xuXHRcdFx0bWltZVR5cGUgPSBzdHJNaW1lVHlwZSB8fCBkZWZhdWx0TWltZSxcblx0XHRcdHBheWxvYWQgPSBkYXRhLFxuXHRcdFx0dXJsID0gIXN0ckZpbGVOYW1lICYmICFzdHJNaW1lVHlwZSAmJiBwYXlsb2FkLFxuXHRcdFx0YW5jaG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIiksXG5cdFx0XHR0b1N0cmluZyA9IGZ1bmN0aW9uKGEpe3JldHVybiBTdHJpbmcoYSk7fSxcblx0XHRcdG15QmxvYiA9IChzZWxmLkJsb2IgfHwgc2VsZi5Nb3pCbG9iIHx8IHNlbGYuV2ViS2l0QmxvYiB8fCB0b1N0cmluZyksXG5cdFx0XHRmaWxlTmFtZSA9IHN0ckZpbGVOYW1lIHx8IFwiZG93bmxvYWRcIixcblx0XHRcdGJsb2IsXG5cdFx0XHRyZWFkZXI7XG5cdFx0XHRteUJsb2I9IG15QmxvYi5jYWxsID8gbXlCbG9iLmJpbmQoc2VsZikgOiBCbG9iIDtcblx0ICBcblx0XHRpZihTdHJpbmcodGhpcyk9PT1cInRydWVcIil7IC8vcmV2ZXJzZSBhcmd1bWVudHMsIGFsbG93aW5nIGRvd25sb2FkLmJpbmQodHJ1ZSwgXCJ0ZXh0L3htbFwiLCBcImV4cG9ydC54bWxcIikgdG8gYWN0IGFzIGEgY2FsbGJhY2tcblx0XHRcdHBheWxvYWQ9W3BheWxvYWQsIG1pbWVUeXBlXTtcblx0XHRcdG1pbWVUeXBlPXBheWxvYWRbMF07XG5cdFx0XHRwYXlsb2FkPXBheWxvYWRbMV07XG5cdFx0fVxuXG5cblx0XHRpZih1cmwgJiYgdXJsLmxlbmd0aDwgMjA0OCl7IC8vIGlmIG5vIGZpbGVuYW1lIGFuZCBubyBtaW1lLCBhc3N1bWUgYSB1cmwgd2FzIHBhc3NlZCBhcyB0aGUgb25seSBhcmd1bWVudFxuXHRcdFx0ZmlsZU5hbWUgPSB1cmwuc3BsaXQoXCIvXCIpLnBvcCgpLnNwbGl0KFwiP1wiKVswXTtcblx0XHRcdGFuY2hvci5ocmVmID0gdXJsOyAvLyBhc3NpZ24gaHJlZiBwcm9wIHRvIHRlbXAgYW5jaG9yXG5cdFx0ICBcdGlmKGFuY2hvci5ocmVmLmluZGV4T2YodXJsKSAhPT0gLTEpeyAvLyBpZiB0aGUgYnJvd3NlciBkZXRlcm1pbmVzIHRoYXQgaXQncyBhIHBvdGVudGlhbGx5IHZhbGlkIHVybCBwYXRoOlxuICAgICAgICBcdFx0dmFyIGFqYXg9bmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIFx0XHRhamF4Lm9wZW4oIFwiR0VUXCIsIHVybCwgdHJ1ZSk7XG4gICAgICAgIFx0XHRhamF4LnJlc3BvbnNlVHlwZSA9ICdibG9iJztcbiAgICAgICAgXHRcdGFqYXgub25sb2FkPSBmdW5jdGlvbihlKXsgXG5cdFx0XHRcdCAgZG93bmxvYWQoZS50YXJnZXQucmVzcG9uc2UsIGZpbGVOYW1lLCBkZWZhdWx0TWltZSk7XG5cdFx0XHRcdH07XG4gICAgICAgIFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IGFqYXguc2VuZCgpO30sIDApOyAvLyBhbGxvd3Mgc2V0dGluZyBjdXN0b20gYWpheCBoZWFkZXJzIHVzaW5nIHRoZSByZXR1cm46XG5cdFx0XHQgICAgcmV0dXJuIGFqYXg7XG5cdFx0XHR9IC8vIGVuZCBpZiB2YWxpZCB1cmw/XG5cdFx0fSAvLyBlbmQgaWYgdXJsP1xuXG5cblx0XHQvL2dvIGFoZWFkIGFuZCBkb3dubG9hZCBkYXRhVVJMcyByaWdodCBhd2F5XG5cdFx0aWYoL15kYXRhOihbXFx3Ky1dK1xcL1tcXHcrLi1dKyk/Wyw7XS8udGVzdChwYXlsb2FkKSl7XG5cdFx0XG5cdFx0XHRpZihwYXlsb2FkLmxlbmd0aCA+ICgxMDI0KjEwMjQqMS45OTkpICYmIG15QmxvYiAhPT0gdG9TdHJpbmcgKXtcblx0XHRcdFx0cGF5bG9hZD1kYXRhVXJsVG9CbG9iKHBheWxvYWQpO1xuXHRcdFx0XHRtaW1lVHlwZT1wYXlsb2FkLnR5cGUgfHwgZGVmYXVsdE1pbWU7XG5cdFx0XHR9ZWxzZXtcdFx0XHRcblx0XHRcdFx0cmV0dXJuIG5hdmlnYXRvci5tc1NhdmVCbG9iID8gIC8vIElFMTAgY2FuJ3QgZG8gYVtkb3dubG9hZF0sIG9ubHkgQmxvYnM6XG5cdFx0XHRcdFx0bmF2aWdhdG9yLm1zU2F2ZUJsb2IoZGF0YVVybFRvQmxvYihwYXlsb2FkKSwgZmlsZU5hbWUpIDpcblx0XHRcdFx0XHRzYXZlcihwYXlsb2FkKSA7IC8vIGV2ZXJ5b25lIGVsc2UgY2FuIHNhdmUgZGF0YVVSTHMgdW4tcHJvY2Vzc2VkXG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9ZWxzZXsvL25vdCBkYXRhIHVybCwgaXMgaXQgYSBzdHJpbmcgd2l0aCBzcGVjaWFsIG5lZWRzP1xuXHRcdFx0aWYoLyhbXFx4ODAtXFx4ZmZdKS8udGVzdChwYXlsb2FkKSl7XHRcdFx0ICBcblx0XHRcdFx0dmFyIGk9MCwgdGVtcFVpQXJyPSBuZXcgVWludDhBcnJheShwYXlsb2FkLmxlbmd0aCksIG14PXRlbXBVaUFyci5sZW5ndGg7XG5cdFx0XHRcdGZvcihpO2k8bXg7KytpKSB0ZW1wVWlBcnJbaV09IHBheWxvYWQuY2hhckNvZGVBdChpKTtcblx0XHRcdCBcdHBheWxvYWQ9bmV3IG15QmxvYihbdGVtcFVpQXJyXSwge3R5cGU6IG1pbWVUeXBlfSk7XG5cdFx0XHR9XHRcdCAgXG5cdFx0fVxuXHRcdGJsb2IgPSBwYXlsb2FkIGluc3RhbmNlb2YgbXlCbG9iID9cblx0XHRcdHBheWxvYWQgOlxuXHRcdFx0bmV3IG15QmxvYihbcGF5bG9hZF0sIHt0eXBlOiBtaW1lVHlwZX0pIDtcblxuXG5cdFx0ZnVuY3Rpb24gZGF0YVVybFRvQmxvYihzdHJVcmwpIHtcblx0XHRcdHZhciBwYXJ0cz0gc3RyVXJsLnNwbGl0KC9bOjssXS8pLFxuXHRcdFx0dHlwZT0gcGFydHNbMV0sXG5cdFx0XHRkZWNvZGVyPSBwYXJ0c1syXSA9PSBcImJhc2U2NFwiID8gYXRvYiA6IGRlY29kZVVSSUNvbXBvbmVudCxcblx0XHRcdGJpbkRhdGE9IGRlY29kZXIoIHBhcnRzLnBvcCgpICksXG5cdFx0XHRteD0gYmluRGF0YS5sZW5ndGgsXG5cdFx0XHRpPSAwLFxuXHRcdFx0dWlBcnI9IG5ldyBVaW50OEFycmF5KG14KTtcblxuXHRcdFx0Zm9yKGk7aTxteDsrK2kpIHVpQXJyW2ldPSBiaW5EYXRhLmNoYXJDb2RlQXQoaSk7XG5cblx0XHRcdHJldHVybiBuZXcgbXlCbG9iKFt1aUFycl0sIHt0eXBlOiB0eXBlfSk7XG5cdFx0IH1cblxuXHRcdGZ1bmN0aW9uIHNhdmVyKHVybCwgd2luTW9kZSl7XG5cblx0XHRcdGlmICgnZG93bmxvYWQnIGluIGFuY2hvcikgeyAvL2h0bWw1IEFbZG93bmxvYWRdXG5cdFx0XHRcdGFuY2hvci5ocmVmID0gdXJsO1xuXHRcdFx0XHRhbmNob3Iuc2V0QXR0cmlidXRlKFwiZG93bmxvYWRcIiwgZmlsZU5hbWUpO1xuXHRcdFx0XHRhbmNob3IuY2xhc3NOYW1lID0gXCJkb3dubG9hZC1qcy1saW5rXCI7XG5cdFx0XHRcdGFuY2hvci5pbm5lckhUTUwgPSBcImRvd25sb2FkaW5nLi4uXCI7XG5cdFx0XHRcdGFuY2hvci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYW5jaG9yKTtcblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRhbmNob3IuY2xpY2soKTtcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGFuY2hvcik7XG5cdFx0XHRcdFx0aWYod2luTW9kZT09PXRydWUpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXsgc2VsZi5VUkwucmV2b2tlT2JqZWN0VVJMKGFuY2hvci5ocmVmKTt9LCAyNTAgKTt9XG5cdFx0XHRcdH0sIDY2KTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGhhbmRsZSBub24tYVtkb3dubG9hZF0gc2FmYXJpIGFzIGJlc3Qgd2UgY2FuOlxuXHRcdFx0aWYoLyhWZXJzaW9uKVxcLyhcXGQrKVxcLihcXGQrKSg/OlxcLihcXGQrKSk/LipTYWZhcmlcXC8vLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcblx0XHRcdFx0aWYoL15kYXRhOi8udGVzdCh1cmwpKVx0dXJsPVwiZGF0YTpcIit1cmwucmVwbGFjZSgvXmRhdGE6KFtcXHdcXC9cXC1cXCtdKykvLCBkZWZhdWx0TWltZSk7XG5cdFx0XHRcdGlmKCF3aW5kb3cub3Blbih1cmwpKXsgLy8gcG9wdXAgYmxvY2tlZCwgb2ZmZXIgZGlyZWN0IGRvd25sb2FkOlxuXHRcdFx0XHRcdGlmKGNvbmZpcm0oXCJEaXNwbGF5aW5nIE5ldyBEb2N1bWVudFxcblxcblVzZSBTYXZlIEFzLi4uIHRvIGRvd25sb2FkLCB0aGVuIGNsaWNrIGJhY2sgdG8gcmV0dXJuIHRvIHRoaXMgcGFnZS5cIikpeyBsb2NhdGlvbi5ocmVmPXVybDsgfVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvL2RvIGlmcmFtZSBkYXRhVVJMIGRvd25sb2FkIChvbGQgY2grRkYpOlxuXHRcdFx0dmFyIGYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmKTtcblxuXHRcdFx0aWYoIXdpbk1vZGUgJiYgL15kYXRhOi8udGVzdCh1cmwpKXsgLy8gZm9yY2UgYSBtaW1lIHRoYXQgd2lsbCBkb3dubG9hZDpcblx0XHRcdFx0dXJsPVwiZGF0YTpcIit1cmwucmVwbGFjZSgvXmRhdGE6KFtcXHdcXC9cXC1cXCtdKykvLCBkZWZhdWx0TWltZSk7XG5cdFx0XHR9XG5cdFx0XHRmLnNyYz11cmw7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZik7IH0sIDMzMyk7XG5cblx0XHR9Ly9lbmQgc2F2ZXJcblxuXG5cblxuXHRcdGlmIChuYXZpZ2F0b3IubXNTYXZlQmxvYikgeyAvLyBJRTEwKyA6IChoYXMgQmxvYiwgYnV0IG5vdCBhW2Rvd25sb2FkXSBvciBVUkwpXG5cdFx0XHRyZXR1cm4gbmF2aWdhdG9yLm1zU2F2ZUJsb2IoYmxvYiwgZmlsZU5hbWUpO1xuXHRcdH1cblxuXHRcdGlmKHNlbGYuVVJMKXsgLy8gc2ltcGxlIGZhc3QgYW5kIG1vZGVybiB3YXkgdXNpbmcgQmxvYiBhbmQgVVJMOlxuXHRcdFx0c2F2ZXIoc2VsZi5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpLCB0cnVlKTtcblx0XHR9ZWxzZXtcblx0XHRcdC8vIGhhbmRsZSBub24tQmxvYigpK25vbi1VUkwgYnJvd3NlcnM6XG5cdFx0XHRpZih0eXBlb2YgYmxvYiA9PT0gXCJzdHJpbmdcIiB8fCBibG9iLmNvbnN0cnVjdG9yPT09dG9TdHJpbmcgKXtcblx0XHRcdFx0dHJ5e1xuXHRcdFx0XHRcdHJldHVybiBzYXZlciggXCJkYXRhOlwiICsgIG1pbWVUeXBlICAgKyBcIjtiYXNlNjQsXCIgICsgIHNlbGYuYnRvYShibG9iKSAgKTtcblx0XHRcdFx0fWNhdGNoKHkpe1xuXHRcdFx0XHRcdHJldHVybiBzYXZlciggXCJkYXRhOlwiICsgIG1pbWVUeXBlICAgKyBcIixcIiArIGVuY29kZVVSSUNvbXBvbmVudChibG9iKSAgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBCbG9iIGJ1dCBub3QgVVJMIHN1cHBvcnQ6XG5cdFx0XHRyZWFkZXI9bmV3IEZpbGVSZWFkZXIoKTtcblx0XHRcdHJlYWRlci5vbmxvYWQ9ZnVuY3Rpb24oZSl7XG5cdFx0XHRcdHNhdmVyKHRoaXMucmVzdWx0KTtcblx0XHRcdH07XG5cdFx0XHRyZWFkZXIucmVhZEFzRGF0YVVSTChibG9iKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRydWU7XG5cdH07IC8qIGVuZCBkb3dubG9hZCgpICovXG59KSk7XG4iXX0="}